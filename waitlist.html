<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Join the Waitlist | Fly Buddy</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <nav class="navbar">
    <a href="index.html">Home</a>
    <a href="features.html">Features</a>
    <a href="waitlist.html">Join Waitlist</a>
    <a href="contact.html">Contact</a>
    <a href="donate.html">Donate</a>
  </nav>

  <h1 class="glow">Be Part of Aviation History</h1>
  <p class="center-text">Secure your spot among the first to experience AI-powered flight assistance.<br>Only a limited number of early access slots available.</p>

  <div class="waitlist-container">
    <label for="email"><strong>Enter your email to join:</strong></label><br/>
    <input type="email" id="email" placeholder="you@example.com" required>
    <button onclick="submitEmail()">Join Now</button>
    <p id="confirmation" style="color: green; margin-top: 10px;"></p>
  </div>

  <div class="live-counter">
    <p><strong id="counter">Loading live signup count...</strong></p>
  </div>

  <footer>
    <p>Â© 2025 Fly Buddy. All rights reserved.</p>
  </footer>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbzw-tp0zDAf0WV2kCkIVADvMfX0Uz7mzPd_Zls9bO2ZXohX_yBeiuG7yr-LYcIbz1vF/exec";

    async function submitEmail() {
      const emailInput = document.getElementById("email");
      const confirmation = document.getElementById("confirmation");
      const email = emailInput.value;

      if (!email) {
        confirmation.innerText = "Please enter a valid email.";
        return;
      }

      try {
        await fetch(scriptURL, {
          method: "POST",
          body: new URLSearchParams({ email }),
        });
        confirmation.innerText = "Welcome to the future of aviation!";
        emailInput.value = "";
        loadSignupCount();
      } catch (error) {
        confirmation.innerText = "Something went wrong. Please try again.";
      }
    }

    async function loadSignupCount() {
      try {
        const res = await fetch("https://opensheet.vercel.app/11_JwMlY2YVNyVrzA64ljnCEn_qyuIKfHgXUGSvuVBqI/WaitlistSignups");
        const data = await res.json();
        document.getElementById("counter").innerText = `Pilots Signed Up: ${data.length}`;
      } catch {
        document.getElementById("counter").innerText = "Couldn't load signup count.";
      }
    }

    loadSignupCount();
  </script>
</body>
</html>
